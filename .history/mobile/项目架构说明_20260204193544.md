# 智糖小助手 - 项目架构说明

## 📐 整体架构设计

### 用户角色（3种）
1. **儿童患者**（<12岁）- 游戏化界面，简化功能
2. **青少年患者**（≥12岁）- 完整功能，自主管理
3. **患者家属** - 管理权限，监护功能

### 主页面结构（底部导航栏 - 3个Tab）

```
┌─────────────────────────────────────┐
│                                     │
│          页面内容区域                │
│                                     │
│                                     │
└─────────────────────────────────────┘
┌─────────┬─────────┬─────────────────┐
│  首页   │  问答   │   个人中心      │
└─────────┴─────────┴─────────────────┘
```

---

## 📱 页面详细结构

### 1️⃣ 首页 (`/pages/index/index`)

**页面组成：**
- **仪表盘**（内嵌显示）
  - 当前血糖状态
  - 实时曲线图
  - 血糖曲线模块
  - AI建议区
  
- **同伴板块**（卡片形式，点击跳转）
  - 显示：同伴动态预览
  - 跳转到：`/pages/community/companion`
  
- **互动板块**（卡片形式，点击跳转）
  - 显示：互动内容预览
  - 跳转到：`/pages/community/interaction`

**文件位置：**
- `src/pages/index/index.vue` - 首页主文件
- 复用 `src/store/dashboard.js` - 仪表盘数据
- 复用 `src/store/glucoseCurve.js` - 血糖曲线数据

---

### 2️⃣ 问答页面 (`/pages/chat/chat-complete`)

**核心功能：**
- ✅ AI智能问答（已实现）
- ✅ 多轮对话
- ✅ 语音输入
- ✅ 历史记录
- ✅ **AI专科对话导航**（新增）
  - 报告解读场景
  - 药盒管理场景
  - 健康日记场景
- ✅ **糖糖问答**（新增）
  - 每日判断题
  - 真假PK互动
  - 答案统计展示
  - 科普知识解析

**文件位置：**
- `src/pages/chat/chat-complete.vue` - AI问答主页面
- `src/pages/chat/specialist-scenes.vue` - 专科场景选择页
- `src/store/chat.js` - 聊天状态管理
- `src/store/specialist.js` - 专科对话状态管理

---

### 3️⃣ 个人中心 (`/pages/profile/profile`)

**页面组成：**
- **用户信息区**
  - 头像、昵称
  - 角色切换入口
  
- **健康管理**
  - ✅ 健康计划（点击跳转到 `/pages/health-plan/index`）
  - ✅ 创建计划（点击跳转到 `/pages/health-plan/create`）
  - ✅ 血糖管理报告（新增）
  - 血糖记录
  - 用药档案
  
- **系统设置**
  - ✅ 基础信息收集（新增）
  - ✅ 每日签到（新增）
  - 提醒设置
  - 隐私设置
  - 关于我们

**文件位置：**
- `src/pages/profile/profile.vue` - 个人中心主文件
- `src/pages/profile/glucose-report.vue` - 血糖管理报告
- `src/pages/profile/basic-info.vue` - 基础信息收集
- `src/pages/profile/daily-checkin.vue` - 每日签到

---

## 🗂️ 独立功能页面

### 同伴板块 (`/pages/community/companion`)
- 同伴动态列表
- 经验分享
- 互相鼓励
- **待实现**

### 互动板块 (`/pages/community/interaction`)
- ✅ 呼吸训练功能
- ✅ 电子宠物「糖小怪」
- ✅ 积分系统
- ✅ 奖章系统
- 小游戏（待实现）

**文件位置：**
- `src/pages/community/interaction.vue` - 互动板块主页
- `src/pages/interaction/breathing-setup.vue` - 呼吸训练设置
- `src/pages/interaction/breathing-session.vue` - 呼吸训练执行
- `src/pages/interaction/pet.vue` - 电子宠物页面
- `src/store/interaction.js` - 互动板块状态管理

### 健康计划工坊 (`/pages/health-plan/`)
- ✅ `index.vue` - 计划列表和任务执行
- ✅ `create.vue` - 创建计划向导
- **已实现**

---

## 📂 目录结构

```
src/
├── pages/
│   ├── index/                    # 首页（底部导航Tab1）
│   │   └── index.vue            # 整合仪表盘+同伴+互动入口
│   │
│   ├── chat/                     # 问答页面（底部导航Tab2）
│   │   └── chat-complete.vue    # AI问答核心功能
│   │
│   ├── profile/                  # 个人中心（底部导航Tab3）
│   │   └── profile.vue          # 个人信息+健康管理入口
│   │
│   ├── dashboard/                # 仪表盘相关（独立访问）
│   │   ├── dashboard.vue        # 完整仪表盘页面
│   │   └── role-switcher.vue    # 角色切换测试页
│   │
│   ├── health-plan/              # 健康计划工坊
│   │   ├── index.vue            # 计划列表和任务
│   │   └── create.vue           # 创建计划向导
│   │
│   ├── community/                # 社区功能（待实现）
│   │   ├── companion.vue        # 同伴板块
│   │   └── interaction.vue      # 互动板块
│   │
│   └── login/                    # 登录页面
│       └── login.vue
│
├── store/                        # 状态管理
│   ├── user.js                  # 用户信息
│   ├── dashboard.js             # 仪表盘数据
│   ├── glucoseCurve.js          # 血糖曲线
│   ├── healthPlan.js            # 健康计划
│   └── chat.js                  # AI问答
│
└── components/                   # 公共组件
    ├── GlucoseCurveChart.vue    # 血糖曲线图表
    └── AddGlucoseRecord.vue     # 添加血糖记录
```

---

## 🔄 页面跳转关系

```
首页 (index)
  ├─→ 同伴板块 (community/companion)
  ├─→ 互动板块 (community/interaction)
  └─→ 仪表盘详情 (dashboard/dashboard) [可选]

个人中心 (profile)
  ├─→ 健康计划 (health-plan/index)
  │     └─→ 创建计划 (health-plan/create)
  ├─→ 角色切换 (dashboard/role-switcher)
  └─→ 其他设置页面

问答 (chat)
  └─→ 独立功能，无跳转
```

---

## 🎯 实现优先级

### ✅ 已完成
1. 仪表盘核心功能
2. 血糖曲线功能
3. 健康计划工坊
4. AI问答功能

### 🔄 需要重构
1. **首页整合** - 将仪表盘内嵌到首页，添加同伴和互动入口
2. **个人中心重构** - 整合健康计划等功能入口
3. **底部导航栏** - 配置三个主Tab

### 📝 待实现
1. 同伴板块独立页面
2. 互动板块独立页面
3. 个人中心完善

---

## 🔧 下一步操作

1. **重构首页** - 整合仪表盘 + 添加同伴/互动入口卡片
2. **配置底部导航** - 在 pages.json 中设置 tabBar
3. **重构个人中心** - 添加健康计划等功能入口
4. **创建社区页面** - 同伴和互动板块的独立页面

---

**版本**：v2.0.0  
**更新日期**：2026-02-04  
**架构状态**：重构中
