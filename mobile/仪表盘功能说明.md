# å…¨æ™¯å¥åº·ä»ªè¡¨ç›˜ - åŠŸèƒ½å®ç°è¯´æ˜

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å·²å®Œæˆå…¨æ™¯å¥åº·ä»ªè¡¨ç›˜çš„å‰ç«¯å®ç°ï¼Œæ”¯æŒä¸‰ç§è§’è‰²æ¨¡å¼ï¼š
- **å„¿ç«¥æ¨¡å¼**ï¼ˆ<12å²ï¼‰ï¼šç®€åŒ–æ˜¾ç¤ºï¼Œå¡é€šå½¢è±¡ + èƒ½é‡æ¡
- **é’å°‘å¹´æ¨¡å¼**ï¼ˆâ‰¥12å²ï¼‰ï¼šå®Œæ•´æ•°æ®ï¼ŒåŒ…å«æ›²çº¿å›¾å’Œç»Ÿè®¡æŒ‡æ ‡
- **å®¶å±æ¨¡å¼**ï¼šå…¨éƒ¨åŠŸèƒ½ï¼ŒåŒ…å«è¿œç¨‹ç›‘æŠ¤å’Œé…ç½®æƒé™

## ğŸ¯ å·²å®ç°åŠŸèƒ½

### 1. æ ¸å¿ƒç»„ä»¶

#### çŠ¶æ€ç®¡ç† (`store/dashboard.js`)
- è¡€ç³–æ•°æ®å®æ—¶æ›´æ–°
- è¶‹åŠ¿åˆ†æï¼ˆä¸Šå‡/ä¸‹é™/å¹³ç¨³ï¼Œå¿«é€Ÿ/æ­£å¸¸ï¼‰
- çŠ¶æ€åˆ¤å®šï¼ˆæ­£å¸¸/è­¦å‘Š/ç´§æ€¥/æ•°æ®ä¸­æ–­ï¼‰
- è­¦æŠ¥ç®¡ç†
- è§’è‰²æƒé™æ§åˆ¶

#### ä»ªè¡¨ç›˜é¡µé¢ (`pages/dashboard/dashboard.vue`)
- **å½“å‰çŠ¶æ€åŒº**
  - å„¿ç«¥æ¨¡å¼ï¼šå¡é€šå½¢è±¡ + èƒ½é‡æ¡å¯è§†åŒ–
  - æ­£å¸¸æ¨¡å¼ï¼šæ•°å€¼æ˜¾ç¤º + è¶‹åŠ¿ç®­å¤´
  - åŠ¨æ€èƒŒæ™¯è‰²ï¼ˆæ ¹æ®çŠ¶æ€å˜åŒ–ï¼‰
  
- **ç›®æ ‡åŒºé—´æŒ‡ç¤ºå™¨**
  - å¯è§†åŒ–æ»‘åŠ¨æ¡
  - å½“å‰å€¼å®šä½ç‚¹
  - è„‰å†²åŠ¨ç”»ï¼ˆå¼‚å¸¸çŠ¶æ€ï¼‰
  
- **å®æ—¶æ›²çº¿å›¾**ï¼ˆä»…â‰¥12å²å’Œå®¶å±ï¼‰
  - 1å°æ—¶/6å°æ—¶/24å°æ—¶åˆ‡æ¢
  - ç›®æ ‡åŒºåŸŸé«˜äº®
  - æ•°æ®ç‚¹é¢œè‰²ç¼–ç 
  - ç½‘æ ¼å’Œåæ ‡è½´
  
- **ç»Ÿè®¡æŒ‡æ ‡**ï¼ˆä»…â‰¥12å²å’Œå®¶å±ï¼‰
  - TIRï¼ˆç›®æ ‡èŒƒå›´å†…æ—¶é—´ï¼‰
  - GMIï¼ˆä¼°ç®—ç³–åŒ–è¡€çº¢è›‹ç™½ï¼‰
  - CVï¼ˆè¡€ç³–æ³¢åŠ¨æ€§ï¼‰
  
- **AI å»ºè®®åŒº**
  - åŠ¨æ€å»ºè®®æ–‡æœ¬
  - å¯æ“ä½œæŒ‰é’®
  - åˆ†çº§æ ·å¼ï¼ˆç´§æ€¥/è­¦å‘Š/æç¤ºï¼‰

- **è­¦æŠ¥ç³»ç»Ÿ**
  - ä¸‰çº§è­¦æŠ¥ï¼ˆæç¤º/è­¦å‘Š/ç´§æ€¥ï¼‰
  - é¡¶éƒ¨æ¨ªå¹…æç¤º
  - åŠ¨ç”»æ•ˆæœï¼ˆè„‰å†²/æŠ–åŠ¨ï¼‰
  - æ•°æ®ä¸­æ–­æç¤º

#### å›¾è¡¨å·¥å…· (`utils/chartHelper.js`)
- Canvas ç»˜å›¾å¼•æ“
- è‡ªé€‚åº”å°ºå¯¸
- å¹³æ»‘æ›²çº¿ç»˜åˆ¶
- ç›®æ ‡åŒºåŸŸæ¸²æŸ“
- æ•°æ®ç‚¹æ ‡è®°

#### è§’è‰²åˆ‡æ¢é¡µé¢ (`pages/dashboard/role-switcher.vue`)
- ä¸‰ç§è§’è‰²é€‰æ‹©
- åŠŸèƒ½é¢„è§ˆ
- ä¸€é”®åˆ‡æ¢

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è®¿é—®ä»ªè¡¨ç›˜

```javascript
// ç›´æ¥è·³è½¬åˆ°ä»ªè¡¨ç›˜
uni.navigateTo({
  url: '/pages/dashboard/dashboard'
})
```

### 2. åˆ‡æ¢è§’è‰²æ¨¡å¼

```javascript
// æ–¹å¼1ï¼šé€šè¿‡è§’è‰²åˆ‡æ¢é¡µé¢
uni.navigateTo({
  url: '/pages/dashboard/role-switcher'
})

// æ–¹å¼2ï¼šä»£ç åˆ‡æ¢
import { useDashboardStore } from '@/store/dashboard'
const dashboardStore = useDashboardStore()
dashboardStore.setUserRole('child_under_12') // æˆ– 'teen_above_12', 'guardian'
```

### 3. æ›´æ–°è¡€ç³–æ•°æ®

```javascript
import { useDashboardStore } from '@/store/dashboard'
const dashboardStore = useDashboardStore()

// æ›´æ–°å½“å‰è¡€ç³–å€¼
dashboardStore.updateGlucose({
  value: 5.8,
  trend: 'stable', // 'up', 'down', 'stable'
  trendRate: 'normal' // 'fast', 'normal', 'slow'
})

// æ·»åŠ å†å²æ•°æ®ç‚¹
dashboardStore.addHistoryData({
  timestamp: new Date(),
  value: 5.8
})
```

### 4. æ·»åŠ äº‹ä»¶æ ‡è®°

```javascript
// æ·»åŠ ç”¨é¤äº‹ä»¶
dashboardStore.addEvent({
  type: 'meal',
  timestamp: new Date(),
  description: 'æ—©é¤'
})

// æ·»åŠ è¿åŠ¨äº‹ä»¶
dashboardStore.addEvent({
  type: 'exercise',
  timestamp: new Date(),
  description: 'è·‘æ­¥30åˆ†é’Ÿ'
})
```

### 5. é…ç½®ç›®æ ‡åŒºé—´

```javascript
// ä¿®æ”¹ç›®æ ‡åŒºé—´ï¼ˆä»…å®¶å±æ¨¡å¼ï¼‰
dashboardStore.targetRange = {
  min: 3.9,
  max: 10.0,
  warningLow: 4.4,
  warningHigh: 9.0
}
```

## ğŸ“± è§’è‰²æƒé™è¯´æ˜

### å„¿ç«¥æ¨¡å¼ï¼ˆ<12å²ï¼‰
**å¯è§å†…å®¹ï¼š**
- âœ… å¡é€šå½¢è±¡çŠ¶æ€æ˜¾ç¤º
- âœ… èƒ½é‡æ¡å¯è§†åŒ–
- âœ… ç®€åŒ–çš„æ–‡å­—æç¤º
- âŒ ä¸æ˜¾ç¤ºå…·ä½“æ•°å€¼
- âŒ ä¸æ˜¾ç¤ºæ›²çº¿å›¾
- âŒ ä¸æ˜¾ç¤ºç»Ÿè®¡æŒ‡æ ‡

**è®¾è®¡ç†å¿µï¼š**
é™ä½ç„¦è™‘ï¼Œé€šè¿‡æ¸¸æˆåŒ–æ–¹å¼è®©å„¿ç«¥ç†è§£è‡ªå·±çš„çŠ¶æ€

### é’å°‘å¹´æ¨¡å¼ï¼ˆâ‰¥12å²ï¼‰
**å¯è§å†…å®¹ï¼š**
- âœ… å®Œæ•´è¡€ç³–æ•°å€¼
- âœ… è¶‹åŠ¿ç®­å¤´å’Œæ–‡å­—
- âœ… å®æ—¶æ›²çº¿å›¾ï¼ˆ1h/6h/24hï¼‰
- âœ… ç»Ÿè®¡æŒ‡æ ‡ï¼ˆTIR/GMI/CVï¼‰
- âœ… è¯¦ç»†å»ºè®®å’Œæ“ä½œ
- âœ… äº‹ä»¶æ ‡è®°åŠŸèƒ½

**è®¾è®¡ç†å¿µï¼š**
åŸ¹å…»è‡ªæˆ‘ç®¡ç†èƒ½åŠ›ï¼Œæä¾›å®Œæ•´ä¿¡æ¯æ”¯æŒå†³ç­–

### å®¶å±æ¨¡å¼
**å¯è§å†…å®¹ï¼š**
- âœ… å…¨éƒ¨æ•°æ®è®¿é—®
- âœ… è­¦æŠ¥é…ç½®æƒé™
- âœ… å†å²æ•°æ®å¯¼å‡º
- âœ… è¿œç¨‹ç›‘æŠ¤åŠŸèƒ½
- âœ… å¤šæ‚£è€…ç®¡ç†ï¼ˆé¢„ç•™ï¼‰

**è®¾è®¡ç†å¿µï¼š**
å…¨é¢ç›‘æŠ¤ï¼ŒåŠæ—¶å¹²é¢„ï¼Œæ•°æ®åˆ†æ

## ğŸ¨ çŠ¶æ€ä¸é¢œè‰²ç¼–ç 

### è¡€ç³–çŠ¶æ€
- **æ­£å¸¸**ï¼ˆç»¿è‰² #10B981ï¼‰ï¼šåœ¨ç›®æ ‡åŒºé—´å†…
- **è­¦å‘Š**ï¼ˆé»„è‰² #F59E0Bï¼‰ï¼šæ¥è¿‘é˜ˆå€¼
- **ç´§æ€¥**ï¼ˆçº¢è‰² #EF4444ï¼‰ï¼šè¶…å‡ºå®‰å…¨èŒƒå›´
- **æ•°æ®ä¸­æ–­**ï¼ˆç°è‰² #9CA3AFï¼‰ï¼šä¼ æ„Ÿå™¨å¤±è”

### è¶‹åŠ¿ç®­å¤´
- **â†‘** ç¼“æ…¢ä¸Šå‡
- **â‡ˆ** å¿«é€Ÿä¸Šå‡
- **â†’** å¹³ç¨³
- **â†“** ç¼“æ…¢ä¸‹é™
- **â‡Š** å¿«é€Ÿä¸‹é™

## ğŸ”” è­¦æŠ¥æœºåˆ¶

### æç¤ºçº§
- **è§¦å‘æ¡ä»¶**ï¼šè¶‹åŠ¿å¼‚å¸¸ä½†æœªè¶Šç•Œ
- **è¡¨ç°**ï¼šå»ºè®®åŒºæ–‡å­—é«˜äº®
- **å£°éŸ³/éœ‡åŠ¨**ï¼šå•æ¬¡çŸ­éœ‡åŠ¨

### è­¦å‘Šçº§
- **è§¦å‘æ¡ä»¶**ï¼šæ¥è¿‘é˜ˆå€¼ï¼ˆå¦‚ G < 4.4ï¼‰
- **è¡¨ç°**ï¼šé¡¶éƒ¨é»„è‰²æ¨ªå¹… + é”å±é€šçŸ¥
- **å£°éŸ³/éœ‡åŠ¨**ï¼šé—´æ­‡æ€§é‡å¤éœ‡åŠ¨

### ç´§æ€¥çº§
- **è§¦å‘æ¡ä»¶**ï¼šè¶Šè¿‡å®‰å…¨çº¿ï¼ˆå¦‚ G < 3.9ï¼‰
- **è¡¨ç°**ï¼šå…¨å±çº¢è‰²èƒŒæ™¯ + å¼ºåˆ¶å¼¹çª—
- **å£°éŸ³/éœ‡åŠ¨**ï¼šæŒç»­é«˜åˆ†è´è­¦æŠ¥ï¼ˆè¦†ç›–é™éŸ³ï¼‰

## ğŸ“Š æ•°æ®æ¨¡æ‹Ÿ

å½“å‰ç‰ˆæœ¬ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®è¿›è¡Œæ¼”ç¤ºï¼š
- æ¯5ç§’æ›´æ–°ä¸€æ¬¡è¡€ç³–å€¼
- è‡ªåŠ¨ç”Ÿæˆå†å²æ›²çº¿æ•°æ®
- éšæœºè¶‹åŠ¿å˜åŒ–

**æ¥å…¥çœŸå®æ•°æ®ï¼š**
```javascript
// æ›¿æ¢ simulateDataUpdate å‡½æ•°
// æ¥å…¥ CGM è®¾å¤‡æˆ–åç«¯ API
const updateFromRealData = async () => {
  const response = await fetch('/api/glucose/latest')
  const data = await response.json()
  
  dashboardStore.updateGlucose({
    value: data.glucose_value,
    trend: data.trend,
    trendRate: data.trend_rate
  })
}
```

## ğŸ”§ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**ï¼šVue 3 + Composition API
- **çŠ¶æ€ç®¡ç†**ï¼šPinia
- **UI**ï¼šåŸç”Ÿ uni-app ç»„ä»¶
- **å›¾è¡¨**ï¼šCanvas åŸç”Ÿç»˜åˆ¶
- **åŠ¨ç”»**ï¼šCSS3 Transitions & Animations

## ğŸ“ å¾…æ‰©å±•åŠŸèƒ½

ä»¥ä¸‹åŠŸèƒ½å·²é¢„ç•™æ¥å£ï¼Œå¯æ ¹æ®éœ€æ±‚å®ç°ï¼š

1. **äº‹ä»¶æ ‡è®°äº¤äº’**
   - ç‚¹å‡»æ›²çº¿ä¸Šçš„äº‹ä»¶å›¾æ ‡æŸ¥çœ‹è¯¦æƒ…
   - æ‰‹åŠ¨æ·»åŠ äº‹ä»¶æ ‡è®°
   
2. **å›¾è¡¨è§¦æ‘¸äº¤äº’**
   - é•¿æŒ‰æŸ¥çœ‹å†å²æ•°æ®ç‚¹
   - åå­—å…‰æ ‡è·Ÿéš
   
3. **æ•°æ®å¯¼å‡º**
   - PDF æŠ¥å‘Šç”Ÿæˆ
   - Excel æ•°æ®å¯¼å‡º
   
4. **å¤šæ‚£è€…ç®¡ç†**ï¼ˆå®¶å±æ¨¡å¼ï¼‰
   - åˆ‡æ¢ä¸åŒæ‚£è€…
   - å¯¹æ¯”åˆ†æ
   
5. **ä¸ªæ€§åŒ–é…ç½®**
   - è‡ªå®šä¹‰ç›®æ ‡åŒºé—´
   - è­¦æŠ¥é˜ˆå€¼è®¾ç½®
   - æé†’æ—¶é—´æ®µé…ç½®

## ğŸ› è°ƒè¯•è¯´æ˜

### æŸ¥çœ‹å½“å‰çŠ¶æ€
```javascript
import { useDashboardStore } from '@/store/dashboard'
const dashboardStore = useDashboardStore()

console.log('å½“å‰è¡€ç³–:', dashboardStore.currentGlucose)
console.log('ç”¨æˆ·è§’è‰²:', dashboardStore.userRole)
console.log('å†å²æ•°æ®:', dashboardStore.historyData)
```

### æµ‹è¯•ä¸åŒåœºæ™¯
```javascript
// æµ‹è¯•ä½è¡€ç³–ç´§æ€¥çŠ¶æ€
dashboardStore.updateGlucose({
  value: 3.5,
  trend: 'down',
  trendRate: 'fast'
})

// æµ‹è¯•æ•°æ®ä¸­æ–­
dashboardStore.dataConnection.isConnected = false
dashboardStore.currentGlucose.status = 'data_loss'

// æµ‹è¯•æ­£å¸¸çŠ¶æ€
dashboardStore.updateGlucose({
  value: 5.8,
  trend: 'stable',
  trendRate: 'normal'
})
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚éœ€è¿›ä¸€æ­¥å®šåˆ¶æˆ–é‡åˆ°é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- åŠŸèƒ½éœ€æ±‚æ–‡æ¡£
- ä»£ç æ³¨é‡Š
- Store çŠ¶æ€å®šä¹‰

---

**ç‰ˆæœ¬**ï¼šv1.0.0  
**æœ€åæ›´æ–°**ï¼š2026-02-04
